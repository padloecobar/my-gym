Refactor TODOs â€” my-gym
Created: 2026-01-25

1) Create data hooks folder
- Path: src/hooks/
- Description: Implement `useExercises`, `useSets`, `useSessions`, `useSettings` that wrap lib/db/index.ts calls, subscribe to DB change events, and expose typed CRUD methods.
- Status: not-started

2) Introduce dbService thin API
- Path: my-app/lib/db/index.ts -> my-app/lib/db/service (adapter)
- Description: Expose typed methods (`getAllExercises`, `addSet`, `updateSession`, etc.), hide IndexedDB transaction details, keep compatibility shims.
- Status: not-started

3) Extract page business logic into hooks
- Path: src/hooks/, my-app/components/views/
- Description: Move data loading, aggregation, mutation handlers from `my-app/app/page.tsx`, `my-app/app/history/page.tsx`, `my-app/app/settings/page.tsx` into hooks (e.g., `useLogPageData`, `useHistoryData`, `useSettingsData`) and presentational components.
- Status: not-started

4) Consolidate Set UI components
- Path: my-app/components/SetEditor.tsx (new)
- Description: Create `SetEditor` and small subcomponents (WeightInput, RepsPreset) to replace duplicated logic in `SetBuilder.tsx` and `SetComposer.tsx`. Keep wrappers for backward compat.
- Status: not-started

5) Encapsulate FileMirror & backup IO
- Path: my-app/lib/fileMirror.ts, my-app/lib/backup.ts, my-app/app/settings/page.tsx
- Description: Expose stable APIs (`isSupported()`, `readBackup()`, `writeBackup()`, `syncToFile()`), add feature-detection and graceful fallbacks; update UI to use these APIs.
- Status: not-started

6) Add global UI/UX services
- Path: my-app/components/ToastProvider.tsx, src/hooks/useToast.ts
- Description: Centralize transient UI state; implement `ToastProvider` and `useToast` so `Toast` is driven by provider rather than ad-hoc props.
- Status: not-started

7) PWA & Service Worker abstraction
- Path: my-app/lib/pwa.ts, my-app/components/PwaRegister.tsx, public/sw.js
- Description: Move SW registration and update handling to `lib/pwa.ts`; ensure `PwaRegister` uses it. Keep `public/sw.js` focused on caching.
- Status: not-started

8) Styling and theme consolidation
- Path: my-app/app/globals.css, tailwind config
- Description: Centralize CSS variables and design tokens in `globals.css`; standardize dark mode handling and ensure Tailwind/postcss uses tokens.
- Status: not-started

9) Component cleanup & presentational pattern
- Path: AppShell.tsx, ExerciseCard.tsx, FileMirrorSync.tsx, SetBuilder.tsx, SwipeRow.tsx
- Description: Split heavy components into container/presentational pairs. Containers use hooks/services; presentational components accept props only.
- Status: not-started

10) Types & TS path aliases
- Path: my-app/lib/types.ts, my-app/tsconfig.json
- Description: Consolidate domain types in `lib/types.ts`, ensure new hooks/services use these types, add `paths` aliases for clarity (e.g., `@/hooks/*`, `@/lib/*`).
- Status: not-started

11) Import and lint hygiene
- Path: my-app/eslint.config.mjs
- Description: Run import clean-up, remove dead code, and add ESLint rules to discourage direct DB/io in components.
- Status: not-started

12) Developer docs and migration guide
- Path: docs/dev/REFRACTORING_GUIDE.md
- Description: Document new layout (`src/hooks`, `lib/services`, `components/views`), coding patterns (hooks/services/presentational components), and examples for contributors.
- Status: not-started

Notes:
- Focus: modern Next.js (App Router), React, Tailwind, and modern web CSS as requested.
- Tests: intentionally skipped for now per instruction.
